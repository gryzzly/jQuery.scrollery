/**
 * jQuery.scrollery – simple gallery that uses scrolling.
 * @author Misha Reyzlin <http://mishareyzlin.com>
 * @license – WTFPL <http://sam.zoy.org/wtfpl/>
 * @version 0.4.1
 */
;(function($){$.fn.scrollery=function(opts){var doc=$(document);opts=$.extend({delay:500,hideScrollBar:true,keyboardControls:true},opts);var Scrollery=function(container){this.container=container;this.list=this.container.children('ul');this.items=this.list.children();this.len=this.items.length;this.images=this.list.find('img');this.imagesCounter=0;if(opts.hideScrollBar)this.list.css('overflow-x','hidden');this.loadImages()};Scrollery.prototype={imageDone:function(){this.imagesCounter+=1;if(this.imagesCounter===this.images.length){this.init()}},loadImages:function(){var self=this;this.images.each(function(){if(this.complete){self.imageDone()}else{this.onload=function(){self.imageDone()};this.onerror=function(){self.imageDone()}}})},doScroll:function(){var currentScroll,i;if(this.list.is(':animated'))return;i=0;currentScroll=this.list.scrollLeft();while(i<this.len){i+=1;if(currentScroll<this.positions[i])break}this.list.scrollTo(currentScroll<this.positions[this.len-1]?this.positions[i]:0,opts.delay)},setWidths:function(){var lastItem=this.items.last(),initialMargin=parseInt(this.items.eq(0).css('margin-right'));lastItem.css('margin-right',initialMargin);lastItem.css('margin-right',this.list.outerWidth()-this.images.last().width()-parseInt(lastItem.css('margin-right')));this.scrollDelta=this.childrenWidth+parseInt(this.list.css('padding-left'))+parseInt(this.list.css('padding-right'));this.scrollDelta-=this.list.outerWidth();this.scrollDelta-=parseInt(this.items.eq(0).css('padding-left'));this.scrollDelta-=parseInt(this.items.eq(0).css('padding-right'))},init:function(){var self=this;this.positions=[];this.childrenWidth=0;this.scrollDelta=0;for(var i=0;i<this.len;i+=1){this.positions.push(Math.ceil(parseFloat(this.items.eq(i).position().left)));this.childrenWidth+=this.items[i].clientWidth}this.setWidths();if(this.list.outerWidth()>this.childrenWidth)return;this.container.bind('click.scrollery',function(){self.doScroll()});if(opts.keyboardControls){doc.bind('keydown.scrollery',function(e){var code=e.keyCode||e.which;if(code===39){e.preventDefault();self.doScroll()}})}$(window).resize(function(){self.setWidths()})}};return this.each(function(){new Scrollery($(this))})}}(jQuery));